!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=window.CodeMirror($("#editor")[0],{lineNumbers:!0,matchBrackets:!0,mode:"text/x-php",indentUnit:2,tabSize:2,autofocus:!0,autoCloseBrackets:!0})},{}],2:[function(a,b){b.exports.setOutput=function(a){var b=!!arguments[1],c=$(".output span");c.html(a).removeClass("error"),b&&c.addClass("error"),$(".spinner").fadeOut("fast");var d=moment((new Date).getTime()).format("h:mm a");$(".timestamp").find("span").html(d)},b.exports.showLineError=function(a){$(".CodeMirror-linenumber").each(function(){return Number($(this).html())===a?void $(this).addClass("error-gutter"):void 0})},b.exports.getPrettyFatalErrorMessage=function(a){if(a.length){var b,c,d,e,f=a,g=["\n",/<br \/>/g,/<b>/g,/<\/b>/g,/(Fatal error: +)/g];return a.toLowerCase().indexOf("fatal error")?($.each(g,function(a,b){f=f.replace(b,"")}),b=f.split("in"),c=b[0].trim(),b=f.split("on"),d=b[1].trim(),f=(c+" on "+d).trim(),e=d.split(" "),e=Number(e[1]),[f,e]):[a,1]}}},{}],3:[function(a,b){var c=a("../editor");b.exports.saveCode=function(){if(window.localStorage){var a=c.getValue();window.localStorage.setItem("code",a),$(".timestamp").find("span").html("Code Saved!"),window.mixpanel.track("Code Saved")}},b.exports.loadSavedCode=function(){if(window.localStorage){var a='echo "We\'re running php version: " . phpversion();',b=window.localStorage.getItem("code"),d=b?b:a;c.setValue(d)}}},{"../editor":1}],4:[function(a){"use strict";function b(a){return $.ajax({type:"POST",url:j,data:{code:a},dataType:"json"})}function c(a){return-1!==window.location.host.indexOf(a)}function d(){return c("cloudcontrolled")||c("herokuapp")}function e(){return c("herokuapp")}function f(){var a=l.getValue();return a.length?($(".spinner").fadeIn("fast"),k.track("Code Run",{code:a}),void b(a).done(g).fail(h)):void m.setOutput("Please supply some code...")}function g(a){if(a){var b=a.result,c=a.error,d="";c?(c.line&&c.message&&(m.showLineError(c.line),d="Line "+c.line+": "),d+=c.message,m.setOutput(d,!0)):m.setOutput(b)}}function h(a){if(a){var b=m.getPrettyFatalErrorMessage(a.responseText);m.setOutput(b[0],!0),m.showLineError(b[1]),k.track("Error",{error:a.responseText})}}function i(a){13===a.which&&(a.ctrlKey||a.metaKey)&&(f(),a.preventDefault()),83===a.which&&(a.ctrlKey||a.metaKey)&&(n.saveCode(),a.preventDefault(),k.track("Save Shortcut"))}var j="eval/index.php",k=window.mixpanel||{},l=a("./editor"),m=a("./helpers/EditorHelpers"),n=a("./helpers/StorageHelpers");n.loadSavedCode(),!e()&&d()&&$(".link-to-heroku").fadeIn("fast"),$(document).keydown(i),$(window).unload(n.saveCode.bind(n))},{"./editor":1,"./helpers/EditorHelpers":2,"./helpers/StorageHelpers":3}]},{},[4]);
//# sourceMappingURL=phpepl.js.map